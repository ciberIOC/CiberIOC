# El·laboració EACs IOC Ciber

### Introducció

En el següent document s'explica quines son les passes per realitzar un EAC, el seu marc pedagògic i com poder utilitzar els arxius d'autocorrecció per a màquines Linux.

## Passes a seguir per realitzar els EACS

### Pas 0

Lectura del marc pedagògic sobre el que es basen els EACs.

### Pas 1: Context i esquema bàsic

El redactor de l'EAC penjarà un fil al fòrum de l'aula de coordinació el títol "MP XX EAC X Semestre X XX-XX" (Exemple: MP01 EAC 1 Semestre 1 24-25". En aquest post es posarà la següent informació:

* Títol - nom del EAC.
* Calendari de realització, correcció i publicació de resultats.
* Introducció (un "tweet de 140 caràcters" que expliqui mínimament l'EAC).
* Enumerar els RAs que es treballaran.
* Enumerar els recursos que cal utilitzar per realitzar la pràctica (Recursos tipus Isard, i recursos acadèmics tipus unitat 2, lliçó 1, 2 i 3).
* Criteris d’avaluació que cal publicar.
* Format i data de lliurament.

Tota aquesta informació es publicarà al curs Moodle per part del coordinador amb el següent format:

![image](https://github.com/ciberIOC/autocorrect/assets/156098498/edaebdfd-170e-476d-806c-4ce5c81668c6)

## Pas 2: Enunciat

En aquest pas el redactor del EAC crearà l'enunciat sobre el qual treballarà l'alumnat. L'enunciat es publicarà en el mateix format que tenim la documentació de l'aula i serà feina del coordinador donar el format i publicar-ho al Moodle.

El redactor de l'EAC publicarà l'enunciat en un nou post al fil del fòrum de Coordinació com un arxiu de text i adjuntarà les imatges que calgui incloure. 

El coordinador durà a terme l'activitat, i si tot és correcte, publicarà l'enunciat al Moodle i deixarà una còpia amb el format nou  al fòrum de Coordinació.

En el post de l'enunciat, el redactor de l'EAC també haurà de publicar els mecanismes d'avaluació que s'utilitzarà, si es vol que es publiqui la rúbrica d'avaluació, si vol crear un debat "fòrum" intern dins l'activitat. Caldrà detallar tots aquells aspectes per tal que el coordinador pugui realitzar penjar l'activitat al curs Moodle.

## Pas 3: Realització EAC

Durant la realització del EAC cal anar realitzant el suport necessari a l’alumnat per part del corrector. A nivell global, podem estandarditzar els següents missatges als fòruma:
* Missatge inicial, el dia que comença l'EAC. 
* Missatge a 60h d’acabar, avisant que el temps s’acaba. Alguna indicació general si ho creieu convenient segons el fòrum.
* Missatge final, una vegada acabat el termini de presentació dels EACS, informant de la retroacció disponible que tenen l'alumnat i les principals estadístiques dels resultats obtinguts.

D’altra banda, cal informar si necessiteu màquines penjades a l’IsardVDI a nivell de servidor. Si necessiteu que jo pengi o despengi alguna màquina a l’isard durant uns dies determinat ho podeu marcar al calendari google i m’afegiu ‘jbella@ioc.cat’. D’aquesta manera, me'n recordaré d’anar penjant i tancant els servidors. Les plantilles i els desplegaments els podeu realitzar vosaltres. Recordeu que per tal que la vegi l’alumnat s’ha de compartir a través del grup del mòdul: FPINF_CIB_MXX.

## Pas 4: Solució

Tots els EACs hauran de tenir dues retroaccions:
1) Retroacció en text, realitzada pel redactor de l'EAC, és la resposta "típica" d'un EAC que hauria de rebre l'alumnat. Pot ser per exemple, si és un qüestionari que es mostri la resposta correcta, o si son un conjunt de passos a realitzar, doncs mostrar els passos a fer. Pot tenir format PDF, o es pot mostrar dins l'exercici mateix.
2) Retroacció en vídeo, realitzada pel corrector, aquesta retroacció hauria de mostrar com arribar a la solució, i es realitza sobretot, per tal l'alumnat pugui entendre com s'hi arriba. L'important dels vídeos és que l'alumnat pugui entendre l'EAC.

Totes dues retroaccions es publicaran al fòrum i serà el coordinador qui els pengi. L'alumnat tindrà permisos per descarregar-se l'arxiu de text, però no per descarregar-se el vídeo, el qual es penjarà en la carpeta compartida del mòdul. Tot això, ho realitzarà el coordinador.

## Pas 5: Resultats

Per acabar, el corrector de l'EAC avisarà a través del fòrum quan les qualificacions estiguin penjades. El coordinador farà visibles els resultats. Si no s'informa del contrari, el coordinador publicarà els resultats a les 12:00h del migdia, d'aquesta manera, el corrector podrà programar un missatge per la mateixa hora.

En el missatge final, el corrector haurà de mostrar les principals dades estadístiques. (En procés de realització, cal crear una plantilla sobre la qual importar els arxius csv de Moodle i que cregui un dashboard que es pugui publicar al Moodle. Podem començar amb un simple gràfic de quartils).

## Pas 6: Retroacció EAC per part del corrector/redactor/coordinador

Una vegada obtinguts els resultats, corrector i/o redactor, en el fil del fòrum de l'EAC, publicaran una valoració sobre si cal canviar algun aspecte de l'EAC de cara al any vinent. Es tracta d'avaluar l'EAC 

Per acabar, coordinador fa valoració final de l'EAC tenint en compte els resultats de l'EAC i els comentaris de corrector/redactor.

Es dona per finalitzat l'EAC.
 
# La proposta pedagògica dels EACS

## Introducció

Els EACs son els exercicis d’avaluació que realitzen l’alumnat del curs d’especialització per avaluar els seus aprenentatges. Tenen caràcter discriminatori, ja que la no superació dels EACs els impedeix aprovar l’assignatura.

Aquest document té per objectiu que el conjunt de professors col·laboradors mantinguin una mateixa estructura organitzativa per tal de facilitar la feina a l’alumnat i donar un senyal de continuat en els materials entre mòduls.

Cada Mòdul té un total de 5/6 EACs repartits entre les diverses setmanes que pot durar el curs (14/13 setmanes). Hi ha un decalatge durant el segon trimestre i caldrà tenir-ho en compte a l'hora de realitzar-los.

El document estableix inicialment el marc pedagògic sobre el qual treballarem, l'estructura bàsica d’un EAC, els recursos que teniu disponibles per a realitzar els exercicis, els mecanismes d’avaluació, i per acabar, els diversos tipus d’EACs que es poden realitzar.

## Marc pedagògic

A nivell pedagògic, un EAC pot entendre's de tres formes diferents: com un repàs d’aquells continguts que s’han donat en el marc teòric del mòdul, com una ‘posada en pràctica’ del que s’ha après a nivell teòric, o com un ‘a més a més’ del que s’ha fet a l’aula per tal d’actualitzar el mòdul amb continguts més moderns o més pràctics.

Al llarg del curs, és molt probable que el professorat utilitzi diversos marcs pedagògics, una bona combinació d’aquests acabarà oferint una sensació d'aprenentatge òptima per part de l’alumnat. Alhora, també cal tenir en compte el mateix mòdul, n’hi ha que son una seqüència d’aprenentatges constructius, mentre que n’hi ha d’altres que els aprenentatges de les unitats son independents entre ells.

D'altra banda, tenint present que la PV està orientada a la comprovació d'autoria dels EACs, una opció també pot ser de realitzar un EAC teòrica al final del curs. (Mai superar els 6 EACs)

Sigui com sigui, la col·laboració entre coordinador, redactor i corrector, és bàsica per definir una direcció sobre la qual el marc pedagògic dels EACs d'un mòdul.

## Rols dins la el·laboració d'un EAC

En l'elaboració de l'EAC hi ha tres rols:
* **Coordinador**: És el coordinador del mòdul, s'encarrega sobretot de la maquetació i de preparar-ne la publicació.
* **Redactor**: És qui prepara tot l'EAC, totes les màquines, i el sistema d'avaluació.
* **Corrector**: És qui proporciona suport a l'alumnat, corregeix tot els EACs i publica els missatges al fòrum i les solucions.

## Estructura bàsica d’un EAC

Tots els EACs hauran de contenir com a mínim aquesta estructura:

* **Títol** - nom de l'EAC.
* **Calendari de realització**, correcció i publicació de resultats.
* **Introducció**, un "tweet de 140 caràcters" que expliqui mínimament el EAC.
* **Enumerar els RAs** que es treballaran.
* **Enumerar els recursos** que cal utilitzar per realitzar la pràctica.
* **Enunciat**, part escrita amb els passos a realitzar
* **Criteris d’avaluació** que cal publicar.
* **Format i data de lliurament** de l'EAC.
* **Solució / Retroacció**

### Implementació de l’estructura d’un EAC al Moodle del curs

Tots els EACs queden anunciats de la següent manera en el curs Moodle:

![Captura de pantalla de 2024-06-17 09-45-21](https://github.com/ciberIOC/autocorrect/assets/156098498/6d978f65-43e4-4f9a-b529-8391a025d2fc)

Dins el llibre, inclourem tota la informació de l’EAC de l’estructura bàsica amb l'excepció de l’enunciat. Dins el llibre, a més, també hi haurà els advertiments de còpia o males praxis generals.

Vosaltres haureu de lliurar a través de la Coordinació tota aquesta informació. És responsabilitat del coordinador posar-ho per escrit a l’aula. 

Pel que fa a l’enunciat, el coordinador serà el responsable de donar-li format Wiki.

## Recursos per realitzar EACs

El recurs principal que teniu és l’IsardVDI. Tots rebreu un usuari d’IsardVDI per EAC. Així doncs, 6 EACs son 6 usuaris diferents. 

Cada usuari tindrà permisos avançats per poder realitzar plantilles i tindrà les següents característiques

![image](https://github.com/ciberIOC/autocorrect/assets/156098498/cfce8c35-80fe-426e-bdb5-6c374df1a6c6)

IsardVDI ofereix l'opció de crear plantilles i/o crear desplegaments. Una plantilla és una màquina que pot recrear qualsevol alumne i fer-se-la seva. Un desplegament és una màquina configurada i creada pel professor, que es desplega en el conjunt d'alumnes que nosaltres volem, i que l'alumnat no pot formatar.

Els desplegaments els vam provar inicialment, ofereixen la possibilitat de replicar una plantilla en cadascun dels alumnes i poder-ne fer un seguiment. Però no els hi dona l'opció de reiniciar de forma autònoma les seves màquines i ho vam anar descartant.

Per això, es recomana crear plantilles i associar-les al grup del mòdul en concret. Actualment, existeixen els següents grups d’usuaris a l’Isard:

![image](https://github.com/ciberIOC/autocorrect/assets/156098498/8883a89f-8fb8-46b8-93de-1b21c6f0cf28)

Per vosaltres, els importants son FPINF_CIB, el qual és el que ens ofereix tenir més recursos per als nostres usuaris, i després, el grup de cadascun dels mòduls.

Per tant, si creeu una plantilla heu de tenir en compte, cal que l'associeu al grup del mòdul només quan vulgueu que sigui pública per la classe. Si la voleu deixar disponible només durant el EAC, heu d’estar atents i afegir-la al grup en el moment que es publiqui el EAC.

Tingueu en compte, que les plantilles dels EAC les haurem de deixar obertes per tal que l’alumnat pugui practicar per les proves de validació.

Un dels inconvenients de l’IsardVDI és que totes les màquines s’apaguen després de 3 hores. Com a coordinador, puc convertir una màquina en servidor i que no s’apagui de forma automàtica.

## Servidors propis

Actualment, estem treballant la possibilitat de tenir servidors oberts a l’exterior. La idea és crear un pont entre una IP pública de l’IOC i una xarxa pública de l’IsardVDI. D’aquesta manera, podrem incloure els servidors que vulguem.

D’entrada, volem crear un servidor CTF per poder dur a terme activitats per l’alumnat.

La idea és que la xarxa només sigui accessible per màquines realitzades per professors.

Estem treballant en aquesta línia.

## L’avaluació i tipus dels EAC

L’avaluació dels EACs hauria de tenir sempre un caràcter formatiu. És a dir, el procés avaluatiu ha de tenir un caràcter d’aprenentatge i no només de comprovació d’aprenentatges. 

Es tracta que l'alumnat tingui la possibilitat d'anar millorant el seu aprenentatge en la mesura que se l'avalua. Això ho podem aconseguir de diverses maneres:
* En els qüestionaris tipus test teòric: cal buscar la manera per tal que l'alumnat es pugui autoesmenar.
* En un exercici pràctic, l'alumnat pot anar comprovat si ho va fent bé o no.

Els tipus d'EACS que podem realitzar son:

#### Qüestionaris 

Son els qüestionaris que podem realitzar i que obliguen l’alumnat a trobar la resposta a través de la consulta dels materials.
* Es pot realitzar un qüestionari i cal plantejar-se el nombre d'intents. Si busquem una opció acreditativa, farem un sol intent i sense mostrar la puntuació. Si busquem una opció formativa, mostrarem l'avaluació de l'alumnat i li donarem opcions per autoesmenar-se.
* Es recomana utilitzar la intel·ligència artificial i comprovar la sortida que us dona.

#### Exercicis pràctics a l’IsardVDI

Son la solució que més s’adapta a la línia pedagògica del curs ja que ofereix el mateix entorn de l’alumnat, son fàcilment escalables i ofereixen possibilitats d’autocorrecció.

L’arquitectura bàsica d’un exercici en IsardVDI consta de:
* Unes plantilles creades pel professor redactor sobre les que treballa l’alumnat.
* Un equip que utilitza l’alumnat per comprovar-ne el resultat, que fa funcions d’autocorrecció i que permet guardar els intents que ha realitzat l’alumnat. Aquest equipament es recomana que sigui desplegat per part del professorat.
* Un equip ‘servidor’ que ofereix IPs a tots els equips d’autocorrecció i és capaç de recollir les dades de tot l’alumnat.
* A l’Isard, teniu tots plantilles de màquines ‘servidors’ i màquines d’autocorrecció que podeu editar per adaptar-les a vosaltres. A l’Annex, s’explica el seu funcionament.

L’avaluació d’aquest tipus d’exercicis funciona tal vegada:
* L’alumnat ha de ser capaç d’executar un petit programa en Python que avalúa el seu exercici i li mostra on estan els errors.
* L’alumnat ha de ser capaç de veure el codi d’aquest programa i li facilita entendre on es pot haver equivocat.
* És una bona praxi obrir un qüestionari al Moodle recollint el nombre d'encerts té un l’alumnat. Caldrà alhora, habilitar alguna captura de pantalla que acabi de comprovar l’autoria i èxit de l’exercici, per exemple, una captura PCAP.
* Sempre caldrà realitzar un vídeo explicant com es feia l’exercici i que serveixi a l’alumnat per entendre l’exercici. Aquest vídeo és per a quan ja ha acabat l’exercici i us pot servir per fer preguntes després a les PAF.


#### Exercicis pràctics en local

Poden ser una solució òptima per a quan l’IsardVDI impedeix realitzar correctament la pràctica. 

L’arquitectura bàsica d’un exercici consta de:
* Una màquina virtual creada pel professorat, parametritzada per VirtualBox.
* No es pot exigir més de 8Gb de RAM lliure a l’alumnat (PC amb Windows de 16GB)
* Cal establir mecanismes per autentificar les captures de l’alumnat, per exemple prompt més data/hora.

L’avaluació d’aquest tipus d’exercicis funciona tal vegada:
* L’alumnat pot fer un retorn a través d’un informe amb les diverses captures de pantalla.
* L’alumnat pot fer un retorn a través d’un codi que el professorat comprovarà.
* L’alumnat ha de ser capaç d’entendre l'evolució de la seva pràctica i conèixer si porta el camí correcte.
* Es pot afegir mecanismes de comprovació i autocorrecció.
* Sempre caldrà realitzar un vídeo explicant com es feia l’exercici i que serveixi a l’alumnat per entendre l’exercici. Aquest vídeo és per a quan ja ha acabat l’exercici i us pot servir per fer preguntes després a les PAF.

# Autocorrecció en entorns Linux

## Context

L'objectiu dels col·laboradors dels cursos d'especialització és que es converteixin en docents experts i aportin recursos, suport i aprenentatges a l'alumnat. Actualment, el col·laborador està amb la sensació que la major part del seu temps es dedica a la correcció. A tall d'exemple, comprovar 50 configuracions de diversos tipus i diverses eines que es puguin desplegar en un entorn d'aprenentatge, poden suposar moltes hores d'esforç, que no queda clar que hi hagi un retorn avaluatiu vers a l'alumnnat. Per contra, buscar la forma en què l'alumnat es pugui anar autoavaluant, pugui millorar el seu aprenentatge a través d'aquesta avaluació, i el docent eviti hores de correcció, doncs s'entén que suposa un salt de qualitat important en favor, no només de l'alumnat que és evident, sinó també de la motivació del professorat.

En el següent apartat d'aquest document, explicarem pas a pas, com aixecar el sistema autocorrectiu i quins son els passos a realitzar per part del docent redactor.

## Pas 1: Fer la pràctica/enunciat tenint en compte el sistema avaluatiu

D'entrada, la vostra pràctica/enunciat no hauria de variar si fem autocorrecció o no. Observarem l'esquema de la vostra possible pràctica per entendre totes les parts:

![EACS](https://github.com/ciberIOC/autocorrect/assets/156098498/bfccd3d5-b7f8-41ac-9ee0-0d51343d6431)

**Enunciat/Pràctica**: Son totes les màquines que vosaltres voleu aixecar. És important establir una bona configuració de les seves xarxes, les quals poden ser:
* Xarxa VPN: Una xarxa per connectar-se a la màquina remotament i que ajuda molt al funcionament general [DHCP].
* Xarxa Default: És la xarxa per defecte de totes les màquines i els permet la sortida a Internet [DHCP].
* Altres xarxes internes: Son totes aquelles xarxes que comencen a Isard per "Personal" (tant Personal, com PersonalIOC). En total cada alumne en té 9, heu de vigilar que entre pràctiques no es repeteixin perquè no es barregin les xarxes entre elles. Les podeu fer servir perquè les màquines es vegin entre elles. Son el que en diríem, xarxes internes.

**Client Correct**: És el client que executa les comprovacions a les màquines de l'usuari, per això necessita estar connectada a una xarxa interna amb totes les màquines del mateix alumnat. És també una bona praxi, connectar-la a Defualt i a la VPN. Aquesta màquina, cal crear-la com a desplegament, d'aquesta manera la podem iniciar des de la consola d'administració del professor. Caldrà que l'alumnat sàpiga com configurar la xarxa Personal que uneix màquines i client avaluador. La plantilla del Client és: "Client_Avaluador". Per crear-la, heu de generar un desplegament a tot l'alumnat. Important: a vegades els desplegaments no es fan a tots els alumnes, cal demanar que revisin per si a algú no se l'ha iniciat.

**Server Correct**: És el servidor que recull totes les comprovacions de tot l'alumnat. És una màquina que només crea el professor. Està connectada a totes les màquines de tot l'alumnat. La xarxa XarxaGrup és una xarxa on tot l'alumnat es pot connectar, per tant, tot l'alumnat pot connectar-se a les màquines dels seus companys. Cal fer un avís de respecte i bon funcionament. La XarxaGrup té un DHCP del servidor que treballa sobre la xarxa 172.20.120.0/24. La plantilla del Servidor és: "Servidor_Avaluador". Per crear-la, cal crear una màquina virtual des d'aquesta plantilla i avisar al coordinador per tal que la converteixi en servidor.
 
## Pas 2: Establir els punts de control/avaluació sobre l'enunciat

L'autocorrecció parteix sobretot de peticions ssh que realitzem a les màquines que hem inclòs a l'arxiu 'sistema'. A l'arxiu sistema el primer que haurem de fer és incloure les ips del nostre sistema (també ho podem demanar a l'alumnat):

````
nano sistema
> 172.21.120.11
````
Cal tenir present, que després haurem de configurar els arxius del client tenint present l'ordre sobre el qual es realitzarà la comprovació. Una bona praxi pot ser marcar ja les IPs de l'alumnat per evitar problemes de comprovacions.

Una vegada preparat el sistema, hem d'identificar què volem anar comprovant. Per fer-ho, el millor de tot és generar les mateixes sol·licituds ssh i copiar-ne el resultat que volem comprovar. Podem crear una taula similar a:

| Comanda | Resposta |
| --- | --- |
| `cat /var/lib/suricata/rules/suricata.rules \| grep 2100498` | alert ip any any -> any any (msg:"GPL ATTACK_RESPONSE id check returned root"; content:"uid=0\|28\|root\|29\|"; classtype:bad-unknown; sid:2100498; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;) |
| `curl http://testmynids.org/uid/index.html` |  id=0(root) gid=0(root) groups=0(root) |
| `sudo cat /var/log/suricata/eve.json \| grep ATTACK_RESPONSE` | SURICATA SERVER: add alert to eve.json |

Aquesta és la tasca més complicada, saber què volem i com volem comprovar el funcionament i l'autocorrecció de l'alumnat.

## Pas 3: Crear la màquina client que avaluarà l'estudiant

En aquest moment ja tenim clar quins seran els punts de control, l'enunciat i el sistema sobre el qual treballarem.

Podeu utilitzar la plantilla "CLIENT_AVALUACIO".

En el següent apartat es marcaran totes les passes que cal fer per tal de deixar la màquina preparada per fer el desplegament:

### Editem les xarxes

Quan creem la plantilla, heu de definir tant la xarxa que farà servir per connectar-se a les màquines, com la xarxa grup sobre la que es connectaran amb el servidor.

A l'hora de configurar les xarxes, la xarxa interna de l'alumnat l'haureu de configurar manualment, mentre que la xarxa de grup l'heu de configurar per DHCP.

### Editem machine-id

Quan dupliques/clones una màquina, cal escriure a /etc/machine-id la paraula ‘uninitialized’, d’aquesta manera, la màquina sempre li dona un nou id i tots els clons aniran agafant un IP nova en el DHCP

[https://manpages.ubuntu.com/manpages/bionic/man5/machine-id.5.html]

### Hostname

Hem d'assegurar-nos que el hostname és isard, d'aquesta manera se li demanarà que canviï el hostname quan arrenqui la màquina de comprovació:

````
sudo hostnamectl set-hostname isard
````

### crides.py

Cal canviar el nom de l'arxiu i treure el sufix *.original*.

Després editem les diverses crides que volem generar, un possible exemple:

````
def ssh_system(hostname, ip, res_txt):
    command = "systemctl status ssh.service | grep Active"
    host = ip
    username = 'isard'
    password = 'pirineus'
    resposta_ok = 'Active: active (running)'
    retorn_terminal = 'SSH RUNNING'
    return (crida(command, host, username, password, resposta_ok, retorn_terminal,res_txt))
````
| Paràmetre | Explicació |
| --- | --- |
| `paràmetres entrada` | Cal enviar-li el hostname, la IP des de correc.py |
| `command` | és la comanda que es realitzarà a través de SSH |
| `host` | l'IP de la màquina on volem generar la crida  |
| `username & password` | Es recomana sempre fer servir les credencials per defecte isard:pirineus |
| `resposta_ok` |  És la resposta esperada, cal tenir present que el codi cercarà aquesta resposta dins la sortida que provoqui l'SSH|
| `retorn_terminal` | És el que li apareixerà a l'alumnat quan executi la correcció. Del tipus->> retorn_termial..........OK/FAIL/ERROR |

### correc.py

Cal canviar el nom de l'arxiu i treure el sufix *.original*.

De l'arxiu editarem els espais premarcats, els quals tenen exemples.

**FUNCIONS A CRIDAR A : crides**, inclourem aquelles funcions creades a crides.py. 

Exemple:
> from crides import ssh_system, rule_suricata

**PREPAREM LES DADES PER CRIDAR LES FUNCIONS**, inclourem les IPs i documnets que volem descarregar.

El hostname sempre caldrà realitzar-ho.

Exemple:
> documents = get_documents()
> sistema = get_ips()
> hostname = os.uname()[1]
> ip_host1 = sistema[0]

En aquest exemple, guardem a ip_host1 la única IP del sistema que volem analitzar.

**CRIDEM LES FUNCIONS QUE VOLEM I GUARDEM**, anem fent totes les crides a crides.py que volem realitzar i en l'ordre que nosaltres volem que aparegui.

Exemple:

````
avaluacio_retorn = ssh_system(hostname, ip_host1, res_txt) + ('\n')
avaluacio_retorn = rule_suricata(hostname, ip_host1, res_txt) + ('\n') + avaluacio_retorn 
````


**CRIDEM FUNCIO PER GUARDAR FITXERS**, tenim la opció de recuperar documnets per si volem fer comprovacions. 

Exemple:
````
ip = sistema[0]  //get_ips()
result = download_file(documents, ip)
res_docs = result[0].copy()
res_file = result[1].copy()
res_errors = result[2].copy()
for errorr in res_errors:
    print (errorr)
for index_file in range(len(res_docs)):
    msg = "Document: " + b.OK + res_file[index_file] + b.ENDC + "\n" + res_docs[index_file]
    avaluacio_retorn = msg + avaluacio_retorn
````

Tingueu en compte que el programa d'autocorrecció guarda l'últim intent a avaluacio.txt, però després, també guarda tots els intents a MongoDB.

### Crear la plantilla

Una vegada ja ho tingueu tot preparat, ja podeu crear la plantilla sobre la qual es basarà el vostre desplegament. Abans de crear-la, tingueu en compte:

**NOM PLANTILLA**, el nom de la plantilla serà: "MPXX-EACXX-CURSXX:XX-CLIENT_AVAL_TEMPLATE"

**MACHINE-ID i HOSTNAME**, comproveu que estan correctes abans de crear la plantilla i tancar la màquina.

**GRUP PLANTILLA**, d'entrada, posareu la plantilla en el grup de professors col·laboradors: FPINF_CIB_COLAB.

**Xarxes**, comproveu que teniu les xarxes ben configurades i que no s'encavalcaran.

### Desplegament

Una vegada feta la plantilla, podeu crear el desplegament i deixar-lo com a no visible, d'aquesta manera el fareu visible només en el moment de l'EAC. Quan genereu el desplegament, llavors sí que podreu posar-lo en el grup del vostre mòdul.

**NOM DESPLEGAMENT**, el nom serà "MPXX-EACXX-CURSXX:XX-CLIENT_AVAL_DESPL"

**GRUP DESPLEGAMENT**, cal marcar el grup del mòdul. Quan vulgueu que el desplegament sigui visible, l'haureu de mostrar com a visible, d'entrada tots els desplegaments es generen com a no visibles.

## Pas 4: Crear la màquina servidor que recull les avaluacions

El servidor és una sola màquina que haureu de preparar tenint present la plantilla "SERVIDOR_AVALUACIO" i que haureu de realitzar les següents passes:

### Xarxes

Quan creeu la màquina, comproveu que les xarxes son correctes i que estan ben configurades.

### correccio.py

Cal canviar el nom de l'arxiu i treure el sufix *.original*.

Només heu d'editar l'apartat següent:

**llista comandes a executar**, son les comandes que generem del nostre servidor, vers tots els clients avaluadors de l'alumnat. D'entrada, tots haurien de ser imprimir avaluacio.txt, però es deixa així per si es vol adaptar.

````
commands = [ "cat /home/isard/avaluacio/avaluacio.txt"]
````

Tota la sortida es guardarà en dos arxius que vosaltres definireu. En un arxiu obtindreu l'última avaluació, i per l'altra, obtindreu un arxiu de text amb la sortida de MongoDB amb tots els intents.

## Pas 5: Guardar els resultats a l'aula de coordinació

Ambdós arxius els haureu de guardar a l'aula de coordinació i els podrem utilitzar per millorar-ne l'autoavaluació.

## Reptes de futur

La part més important a intentar aconseguir és com fer avaluacions automàtiques tenint les dades de MongoDB més extenses. Algunes informacions poden ser d'ús intern i d'altres per ser publicadas, però amb les dades de MongoDB podríem saber:

- El temps mitjà que ha trigat un alumne, des del primer intent d'avaluació, a l'últim. També podríem capturar el temps de creació de la màquina per part de l'alumnat. I tindríem el temps final.
- Podem saber si alguna part de l'exercici s'ha quedat encallat.
- Podem saber quants intents ha necessitat per cada apartat.
- Quants intents s'han fet en total.

En l'àmbit del propi programa:
- Connexió a través de claus público/privadas
- Establir mecanismes de control del programa a través del hash
- 












